<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Hello, my name is Chris Diana! I am a developer and designer with a passion for innovative technology currently based in Boulder, CO.">
    <title>Getting Started with Slim Framework - Creating a RESTful API | Chris Diana</title>

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="manifest" href="/assets/img/icons/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    <!-- RSS -->
    <link rel="alternate" href="/feed.xml" type="application/atom+xml" title="Chris Diana">

    <!-- OpenGraph -->
    <meta property="og:site_name" content="Chris Diana" />
    <meta property="og:title" content="Getting Started with Slim Framework - Creating a RESTful API"/>
    <meta property="og:description" content="Here's a quick tutorial to get up and running with Slim PHP Framework to start building RESTful applications." />
    <meta property="og:image" content="" />
    <meta property="og:url" content="https://chris-diana.com/posts/2015-01-27-getting-started-with-slim-framework/" >
    <meta property="og:type" content="blog" />
    <meta property="article:published_time" content="2019-02-15">

    <!-- CSS -->
    <link href="//fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i" rel="stylesheet">
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link href="//cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Adamina|Open+Sans:400,400i,700,700i" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="/assets/css/prism-base16-monokai.dark.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/medium-2.css">
    <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css" />
    <link rel="stylesheet" href="/assets/css/blog.css">
  </head>
  <body>
    <div class="mini-banner"></div>

    <div id="navbar" class="navbar">
      <nav class="nav">
        <a id="logo" href="#" class="logo">
          <img src="/assets/img/logo.png"/>
        </a>
        <div id="nav-content" class="nav-content">
          <ul class="nav-list">
            <li><a href="/">Blog</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="#" id="btn-search" class="btn btn--search">
              <i class="sli icon-magnifier"></i></a>
            </li>
          </ul>
        </div>
      </nav>
    </div>

    <div class="search">
      <a href="#" id="btn-search-close" class="btn btn--search-close">
        <i class="sli icon-close"></i>
      </a>
			<form class="search__form" action="">
				<input
          id="search"
          class="search__input"
          name="search"
          type="search"
          placeholder=""
          autocomplete="off"
          autocorrect="off"
          autocapitalize="off"
          spellcheck="false" />
				<span class="search__info">Hit enter to search or ESC to close</span>
			</form>

      <div class="search-suggestions">
        <div class="search__suggestion">
          <ul id="search-suggestion-list" class="search__suggestion__list"></ul>
        </div>
      </div>
      <!--
			<div class="search__related">
				<div class="search__suggestion">
          <h3>May I Suggest?</h3>
          <p>#javascript #react #d3 #php</p>
				</div>
				<div class="search__suggestion">
          <ul id="search-suggestion-list" class="search__suggestion__list"></ul>
				</div>
			</div>
      -->
		</div>

    <!-- MAIN -->
    <main class="content main">
      <article class="post">
  <div class="noarticleimage">

    <div class="post-meta">
      <h1 class="post-title">Getting Started with Slim Framework - Creating a RESTful API</h1>
      <!--
      <span class="post-date">
        02-15-2019
      </span>
      -->
      <div class="post-meta-text">
        
          <a class="tag tag-php" href="#">
            php
          </a>
        
          <a class="tag tag-framework" href="#">
            framework
          </a>
        
          <a class="tag tag-mvc" href="#">
            mvc
          </a>
        
          <a class="tag tag-rest" href="#">
            rest
          </a>
        
          <a class="tag tag-api" href="#">
            api
          </a>
        
          <a class="tag tag-slim" href="#">
            slim
          </a>
        
      </div>
    </div>
    <section class="post-content">

      <p>Here's a quick tutorial to get up and running with Slim PHP Framework to start building
RESTful applications.</p>
<p><strong>Why a REST API?</strong></p>
<p>A REST API acts like a middle-man between clients (mobile devices, computers) and the database server.
This type of infrastructure allows clients using completely different technologies
or operating systems to communicate in one type of protocol. That way as technologies
change, the method of communication with the database and server logic can remaind
the same. Just remember, the application we are building is meant to be used
with client applications and not really meant for actual users to be using it...
so it's not going to look very pretty. We will be building <a href="/2015/03/20/getting-started-with-slim-framework-pt-2/">a nice looking client
application later</a> that will be used to interact with the API--and that will look pretty.</p>
<p><strong>Why use Slim?</strong></p>
<p>Slim is a micro framework for PHP that allows you to quickly build web applications and APIs.
I like Slim because it's super lightweight (only about 283kb for the entire framework) as
opposed to larger PHP frameworks like Codeigniter and Symfony, which have a lot of extra fluff.
This means that's it really fast, and great for building a REST API for use on a multitude of
devices.</p>
<hr>
<h3>1. Install</h3>
<p>You can start by downloading it <a href="https://github.com/codeguy/Slim">here</a> and
extract the Slim framework into your project directory.</p>
<h3>2. Create a database</h3>
<p>Login into MySQL and create a new database to have our Slim application interact
with.</p>
<pre class="language-sql"><code class="language-sql"><span class="highlight-line"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> garage<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">USE</span> garage<span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> cars <span class="token punctuation">(</span></span><br><span class="highlight-line">	id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">UNSIGNED</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span></span><br><span class="highlight-line">	<span class="token keyword">year</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> make <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></span><br><span class="highlight-line">	model <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></span><br><span class="highlight-line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Insert some sample data into the database.</p>
<pre class="language-sql"><code class="language-sql"><span class="highlight-line"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> cars <span class="token punctuation">(</span><span class="token keyword">year</span><span class="token punctuation">,</span> make<span class="token punctuation">,</span> model<span class="token punctuation">)</span> <span class="token keyword">VALUES</span></span><br><span class="highlight-line">	<span class="token punctuation">(</span><span class="token number">1991</span><span class="token punctuation">,</span> <span class="token string">'Ferrari'</span><span class="token punctuation">,</span> <span class="token string">'Testarossa'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><br><span class="highlight-line">	<span class="token punctuation">(</span><span class="token number">1994</span><span class="token punctuation">,</span> <span class="token string">'Acura'</span><span class="token punctuation">,</span> <span class="token string">'NSX'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><br><span class="highlight-line">	<span class="token punctuation">(</span><span class="token number">1992</span><span class="token punctuation">,</span> <span class="token string">'Toyota'</span><span class="token punctuation">,</span> <span class="token string">'Corolla'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<h3>3. Download NotORM</h3>
<p>We are also going to use a plugin called <a href="http://www.notorm.com/">NotORM</a>
that will make working with the database easier. Create a <code>plugins</code> folder in your
project directory and place the downloaded NotORM plugin inside it. Your directory
should look like this:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">- .htaccess</span><br><span class="highlight-line">- index.php</span><br><span class="highlight-line">- Slim/</span><br><span class="highlight-line">- plugins/</span><br><span class="highlight-line">- - NotORM/</span><br><span class="highlight-line">- - NotORM.php</span></code></pre>
<h3>4. Remove and replace index.php</h3>
<p>Now, just delete the included <code>index.php</code> and create a new one as were are going
to going through it step by step. In your <code>index.php</code> file add this lines. This
will require the framework, register the autoloader and instantiate the Slim
application. Also, we are requiring the NotORM library for handling the database.</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">/* Require Slim and plugins */</span></span><br><span class="highlight-line"><span class="token keyword">require</span> <span class="token single-quoted-string string">'Slim/Slim.php'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">require</span> <span class="token single-quoted-string string">'plugins/NotORM.php'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">/* Register autoloader and instantiate Slim */</span></span><br><span class="highlight-line">\<span class="token package">Slim<span class="token punctuation">\</span>Slim</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">registerAutoloader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Slim<span class="token punctuation">\</span>Slim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<h3>5. NotORM Database Configuration</h3>
<p>We need to setup the NotORM library so it can talk with the database:</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">/* Database Configuration */</span></span><br><span class="highlight-line"><span class="token variable">$dbhost</span>   <span class="token operator">=</span> <span class="token single-quoted-string string">'localhost'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token variable">$dbuser</span>   <span class="token operator">=</span> <span class="token single-quoted-string string">'root'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token variable">$dbpass</span>   <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token variable">$dbname</span>   <span class="token operator">=</span> <span class="token single-quoted-string string">'garage'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token variable">$dbmethod</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'mysql:dbname='</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token variable">$dsn</span> <span class="token operator">=</span> <span class="token variable">$dbmethod</span><span class="token punctuation">.</span><span class="token variable">$dbname</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token variable">$dsn</span><span class="token punctuation">,</span> <span class="token variable">$dbuser</span><span class="token punctuation">,</span> <span class="token variable">$dbpass</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token variable">$db</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NotORM</span><span class="token punctuation">(</span><span class="token variable">$pdo</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<h3>6. Setup our first Route</h3>
<p>Now we are going to setup a HTTP GET route for the home URL. In this step, we
will actually be able to start to see our application work. Below the database
configuration add:</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">/* Routes */</span></span><br><span class="highlight-line"><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">echo</span> <span class="token single-quoted-string string">'Home - My Slim Application'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">/* Run the application */</span></span><br><span class="highlight-line"><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>If you visit <code>http://localhost/slim-cars/</code> you should now see your home message
from above.</p>
<p>We have the Slim application working, so now we are going to setup routes for
RESTful Web Services, using GET, PUT, POST and DELETE to handle
CRUD (Create, Read, Update, Delete) operations.</p>
<h3>7. Getting the Cars</h3>
<p>Now that we have our Slim app up and running, we need to get items from the
database. We are going to create a new route so that when a user (or device) hits
your base url and then <code>/cars</code>, it will return a list of all cars in the database in
JSON format. Right below your <code>home</code> route (and above the <code>$app-&gt;run()</code>) add:</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">// Get all cars</span></span><br><span class="highlight-line"><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/cars'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token variable">$cars</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">cars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$car</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token variable">$cars</span><span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$car</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'year'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$car</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'year'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'make'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$car</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'make'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'model'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$car</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'model'</span><span class="token punctuation">]</span></span><br><span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line">    <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$cars</span><span class="token punctuation">,</span> <span class="token constant">JSON_FORCE_OBJECT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Here is what happens: First, we tell Slim we are setting up a HTTP GET Route
<code>/cars</code>. We add paramaters <code>$app</code> and <code>$db</code> to tell Slim to use the Slim app and
NotORM database library. We then create an empty cars array and loop through the
database getting all cars. Finally, we set the repsonse header to JSON and echo
the cars array as a JSON object. If you hit <code>http://localhost/slim-cars/cars</code> in
your browser, you should now see all the cars in the database as JSON.</p>
<p>Alternatively , we can use cURL to test the GET request. Pull up your terminal
and type:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">$ <span class="token function">curl</span> -i -X GET http://localhost/slim-cars/cars</span></code></pre>
<p>You should get a response similar to this:</p>
<pre><code>HTTP/1.1 200 OK
Date: Wed, 18 Feb 2015 14:24:19 GMT
Server: Apache/2.4.9 (Unix) PHP/5.5.14
X-Powered-By: PHP/5.5.14
Content-Length: 189
Content-Type: application/json

{&quot;0&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;year&quot;:&quot;1991&quot;,&quot;make&quot;:&quot;Ferrari&quot;,&quot;model&quot;:&quot;Testarossa&quot;},&quot;1&quot;:{&quot;id&quot;:&quot;2&quot;,&quot;year&quot;:&quot;1994&quot;,&quot;make&quot;:&quot;Acura&quot;,&quot;model&quot;:&quot;NSX&quot;},&quot;2&quot;:{&quot;id&quot;:&quot;3&quot;,&quot;year&quot;:&quot;1992&quot;,&quot;make&quot;:&quot;Toyota&quot;,&quot;model&quot;:&quot;Corolla&quot;}}
</code></pre>
<h3>8. Getting A Single Car</h3>
<p>We've setup a route to get all the cars, but what if we just want a single car?
We'll follow a similar structure as above:</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">// Get a single car</span></span><br><span class="highlight-line"><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/cars/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$db</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token variable">$car</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">cars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">where</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$car</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'year'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'year'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'make'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'make'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'model'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'model'</span><span class="token punctuation">]</span></span><br><span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line">    <span class="token keyword">else</span><span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'status'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">false</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token single-quoted-string string">'message'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Car ID <span class="token interpolation"><span class="token variable">$id</span></span> does not exist"</span></span><br><span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Similar to getting all the cars, we create a GET Route but this time we have a
callback argument <code>:id</code> added after <code>cars/</code>. This id is passed into the function
and then reads the cars from the database, finding only the car that matches the
id. Then, it encodes the result into JSON format and echos it back. If the car id
doesn't exist, it returns an error message.</p>
<p>Now let's test it out using cURL:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">$ <span class="token function">curl</span> -i -X GET http://localhost/slim-cars/cars/1</span></code></pre>
<p>You should get back:</p>
<pre><code>HTTP/1.1 200 OK
Date: Wed, 18 Feb 2015 14:24:37 GMT
Server: Apache/2.4.9 (Unix) PHP/5.5.14
X-Powered-By: PHP/5.5.14
Content-Length: 62
Content-Type: application/json

{&quot;id&quot;:&quot;1&quot;,&quot;year&quot;:&quot;1991&quot;,&quot;make&quot;:&quot;Ferrari&quot;,&quot;model&quot;:&quot;Testarossa&quot;}
</code></pre>
<h3>9. Adding a Car</h3>
<p>We retrieved cars from the database, but what about adding a new one? We will be
using the POST web service to signal creation of a new car in the database. To
do this, let's add this below the <code>Get a single car</code> route:</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">// Add a new car</span></span><br><span class="highlight-line"><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">post</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/car'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token variable">$car</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">cars</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token variable">$car</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Let's use cURL to try adding a new car.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">$ <span class="token function">curl</span> -X POST -d <span class="token string">"year=1981&amp;make=DeLorean&amp;model=DMC-12"</span> http://localhost/slim-cars/car</span></code></pre>
<p>If you log back into MySQL, you should now see your new car added to the database.</p>
<h3>10. Updating a Car</h3>
<p>Now we are going to add an UPDATE route in order to edit current cars in the
database. To do this, we are going to be using the PUT method:</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">// Update a car</span></span><br><span class="highlight-line"><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">put</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/car/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token variable">$car</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">cars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">where</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"id"</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$car</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token variable">$post</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$car</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">update</span><span class="token punctuation">(</span><span class="token variable">$post</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"status"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>bool<span class="token punctuation">)</span><span class="token variable">$result</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"message"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Car updated successfully"</span></span><br><span class="highlight-line">            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line">    <span class="token keyword">else</span><span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"status"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">false</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"message"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Car id <span class="token interpolation"><span class="token variable">$id</span></span> does not exist"</span></span><br><span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Similar to getting a single car, we are using a callback argument <code>:id</code> to tell
the application which car we want to edit. We then grab the car with the correct
id from the database and update it. If the update was successful, we'll echo a
success message. If the car doesn't exist, well echo that the car doesn't exist.</p>
<p>We can test this out using cURL PUT method in terminal:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">$ <span class="token function">curl</span> -X PUT -d <span class="token string">"year=2015&amp;make=Lamborghini&amp;model=700-4"</span> http://localhost/slim-cars/car/3</span></code></pre>
<h3>11. Removing a Car</h3>
<p>The last thing we need to be able to do is remove a car. We are going to be using
the DELETE method to remove cars. Here's how we are going to setup our DELETE route:</p>
<pre class="language-php"><code class="language-php"><span class="highlight-line"><span class="token comment">// Remove a car</span></span><br><span class="highlight-line"><span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/car/:id'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token keyword">use</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token variable">$app</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">header</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token double-quoted-string string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token variable">$car</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">cars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">where</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$car</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$car</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"status"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">true</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"message"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Car deleted successfully"</span></span><br><span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line">    <span class="token keyword">else</span><span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"status"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">false</span><span class="token punctuation">,</span></span><br><span class="highlight-line">            <span class="token double-quoted-string string">"message"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token double-quoted-string string">"Car id <span class="token interpolation"><span class="token variable">$id</span></span> does not exist"</span></span><br><span class="highlight-line">        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Similar to above, we are using the callback argument to get a specific car by their
id. Then, we find that car in the database and delete it using NotORM's <code>delete()</code>
method. We will then echo back a message if the car was successfully deleted, or if
the car does not exist.</p>
<p>We can test out this functionality using cURL DELETE:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">$ <span class="token function">curl</span> -i -X DELETE http://localhost/slim-cars/car/4</span></code></pre>
<h3>Conclusion</h3>
<p>We'll there you have it, we have just built a RESTful application that can be used to GET, POST,
PUT and DELETE items from the database. This is a great starting point and can be
expanded to include more methods, routes, and even authentication.</p>
<p>You can download the source of this app in a step by step (in GIT) version on <a href="https://github.com/chrisdiana/slim-cars">Github</a>.</p>
<p>The next step in this tutorial is to create a client that will communicate with
this REST API that we've just built - <a href="/posts/2015-03-20-getting-started-with-slim-framework-pt-2/">Getting Started with Slim Framework - Part 2</a></p>
<hr>
<p>Other Resources</p>
<ul>
<li><a href="http://docs.slimframework.com">Slim Documentation</a></li>
<li><a href="http://coenraets.org/blog/2011/12/restful-services-with-jquery-php-and-the-slim-framework/">RESTful services with jQuery, PHP and the Slim Framework</a></li>
<li><a href="http://www.sitepoint.com/writing-a-restful-web-service-with-slim/">Writing a RESTful Web Service with Slim</a></li>
<li><a href="http://code.tutsplus.com/tutorials/taming-slim-20--net-30669">Taming Slim 2.0</a></li>
<li><a href="http://www.slimframework.com/news/how-to-organize-a-large-slim-framework-application">How to organize a large slim application</a></li>
<li><a href="http://curl.haxx.se/docs/">cURL Docs</a></li>
</ul>


      <a href="/">← Home</a><br>
      <p style="text-align:right">
        <a class="edit-link" href="https://github.com/chrisdiana/chrisdiana.github.io/tree/develop/./src/posts/2015-01-27-getting-started-with-slim-framework.md">Edit this page on GitHub</a>
      </p>
    </section>

    <footer class="post-footer"></footer>
    <div id="disqus_thread"></div>
  </div>
</article>

<script>
  var disqus_config = function () {
    //this.page.url = document.location.href;
    this.page.identifier = document.location.pathname.replace('/posts/', '').replace('/', '');
  };
  (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://cdianamedia.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    </main>

    <!-- Footer -->
    <div class="footer">
      <div class="email-signup">
        <hr>
        <div class="social-links-footer">
          <a target="_blank" title="Github" href="//github.com/chrisdiana"><i class="fab fa-github"></i></a>
          <a target="_blank" title="Stack Overflow" href="//stackoverflow.com/users/1073821/chris-diana"><i class="fab fa-stack-overflow"></i></a>
          <a target="_blank" title="NPM" href="//npmjs.com/~chris-diana"><i class="fab fa-npm"></i></a>
          <a target="_blank" title="Dribbble" href="//dribbble.com/chrisdiana"><i class="fab fa-dribbble"></i></a>
          <a target="_blank" title="LinkedIn" href="//www.linkedin.com/in/chris-diana"><i class="fab fa-linkedin"></i></a>
        </div>
        <div class="email-signup-header">Sign up for updates on the latest articles, resources, tutorials and more.</div>
        <form action="https://saturnbit.us10.list-manage.com/subscribe/post?u=6a958cda028d0d312d1ef3ccd&amp;id=02b3438a51" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
          <input type="email" value="" placeholder="Email Address" name="EMAIL" class="required email email-signup-input" id="mce-EMAIL">
          <div id="mce-responses" class="clear">
            <div class="response" id="mce-error-response" style="display:none"></div>
            <div class="response" id="mce-success-response" style="display:none"></div>
          </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
          <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_6a958cda028d0d312d1ef3ccd_02b3438a51" tabindex="-1" value=""></div>
          <button type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button email-signup-button">Signup</button>
        </form>
      </div>
    </div>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127054989-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-127054989-1');
    </script>
    <script src="/assets/js/script.js"></script>
  </body>
</html>
